<!DOCTYPE html>
<html lang="ja">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>3人用将棋クロック</title>
<style>
    body {
        font-family: Arial, sans-serif;
        text-align: center;
        background: #f8f8f8;
    }
    h1 {
        margin: 10px;
    }
    .player {
        font-size: 2em;
        margin: 20px;
        padding: 20px;
        border-radius: 10px;
        background: #fff;
        border: 2px solid #ccc;
    }
    .active {
        border-color: #007bff;
        background: #e0f0ff;
    }
    .timeout {
        color: red;
    }
    button {
        font-size: 1.5em;
        padding: 10px 30px;
        margin: 10px;
    }
</style>
</head>
<body>
    <h1>3人用将棋クロック</h1>
    <div id="playerA" class="player">A: <span id="timeA">0.0</span> 秒</div>
    <div id="playerB" class="player">B: <span id="timeB">0.0</span> 秒</div>
    <div id="playerC" class="player">C: <span id="timeC">0.0</span> 秒</div>

    <button onclick="startTimer('A')">A</button>
    <button onclick="startTimer('B')">B</button>
    <button onclick="startTimer('C')">C</button>

<script>
let current = null;
let timers = { A: 0, B: 0, C: 0 };
let intervals = { A: null, B: null, C: null };

function startTimer(player) {
    stopAll();
    timers[player] = 0;
    ['A','B','C'].forEach(p => {
        document.getElementById('player'+p).classList.remove('active');
        document.getElementById('time'+p).classList.remove('timeout');
    });

    document.getElementById('player' + player).classList.add('active');

    intervals[player] = setInterval(() => {
        timers[player] += 0.1;
        document.getElementById('time' + player).textContent = timers[player].toFixed(1);

        if (timers[player] >= 10) {
            document.getElementById('time' + player).classList.add('timeout');
            beep();
        }
    }, 100);

    current = player;
}

function stopAll() {
    clearInterval(intervals.A);
    clearInterval(intervals.B);
    clearInterval(intervals.C);
}

function beep() {
    const ctx = new (window.AudioContext || window.webkitAudioContext)();
    const osc = ctx.createOscillator();
    const gain = ctx.createGain();
    osc.type = 'square';
    osc.connect(gain);
    gain.connect(ctx.destination);
    osc.start();
    gain.gain.setValueAtTime(0.1, ctx.currentTime);
    osc.stop(ctx.currentTime + 0.2);
}

document.addEventListener('keydown', (e) => {
    if (e.key === 'Enter') {
        if (current === 'A') startTimer('B');
        else if (current === 'B') startTimer('C');
        else startTimer('A');
    }
});
</script>
</body>
</html>
